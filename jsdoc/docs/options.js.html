<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: options.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: options.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/**
 * @namespace Options
 */

/**
 * @memberof Options
 *
 * @typedef {Object} QueryOptions
 *
 * @property {Boolean} [stream=false] - Format the query response as a stream.
 * @property {Object} [pagination=null] Pagination options.
 * @property {Number|String} pagination.page=null - The page number, starting at 1.
 * @property {Number|String} pagination.size=null - The page size, greater than 0.
 *
 * @example
 * { stream: true, pagination: { page: 2, size: 50 } }
 */

/**
 * @memberof Options
 *
 * @typedef {Object} FireFerretOptions
 *
 * @property {options.Mongo} mongo
 * @property {options.Redis} redis
 * @property {boolean} wideMatch=false - Use the Wide-Match strategy when checking the cache for queries.
 */

/**
 * @memberof Options
 *
 * @typedef {Object} Mongo - Dictates MongoDB driver behavior. Additional Driver documentation can be found {@link http://mongodb.github.io/node-mongodb-native/|here}.
 *
 * @property {String} uri - The MongoDB URI.
 * @property {String} dbName - The name of the MongoDB database to connect to.
 * @property {String} collectionName=null - The default database collection.
 * @property {Boolean} ndJSON=false - Stream documents using the ndJSON spec.
 * @property {String} encoding="utf-8" - Encoding to use when streaming.
 */

/**
 * @memberof Options
 *
 * @typedef {Object} Redis - Dictates Redis client behavior. Additional Client documentation can be found {@link https://www.npmjs.com/package/redis#options-object-properties|here}.
 *
 * @property {Boolean} ndJSON=false - Stream documents using the ndJSON spec.
 * @property {Number} connectionTimeout=5000 - Timeout in milliseconds when connecting.
 * @property {Number} count=1000 - Default Redis SCAN work amount.
 * @property {Number} batchSize=1000 - Default batch size when using LPUSH.
 */

const DEFAULTS = {
  cache: {
    wideMatch: true,
  },
  mongo: {
    ndJSON: false,
    encoding: "utf-8",
    dbName: "",
    collectionName: "",
    uri: "",
  },
  mongoClient: {
    useUnifiedTopology: true,
  },
  redisClient: {
    ndJSON: false,
    count: 1000,
    connectionTimeout: 5000,
    batchSize: 1000,
    host: "127.0.0.1",
    port: 6379,
    path: null,
    url: null,
    string_numbers: null,
    return_buffers: false,
    detect_buffers: false,
    socket_keepalive: true,
    socket_initial_delay: 0,
    no_ready_check: false,
    enable_offline_queue: true,
    retry_unfilfilled_commands: false,
    password: null,
    auth_pass: null,
    db: null,
    family: "IPv4",
    disable_resubscribing: null,
    rename_commands: null,
    tls: null,
    prefix: null,
    retry_strategy: null,
  },
};

/**
 * @memberof Options
 *
 * Generate client specific options by filtering out invalid fields.
 *
 * @param {Object} source - The source options to generate from.
 * @param {String} name - Name of the client/driver the options are for.
 * @param {boolean} [setDefaults=true] - If a source value is not present, use the default value.
 *
 * @returns {Object} Client specific options.
 */
function generateOptions(source, name, setDefaults = true) {
  if (!source) return {};

  const options = {};

  const keys = Object.keys(DEFAULTS[name]);
  for (let i = 0; i &lt; keys.length; i++) {
    const key = keys[i];
    if (source[key]) options[key] = source[key];
    else if (setDefaults &amp;&amp; DEFAULTS[name][key] !== null) {
      options[key] = DEFAULTS[name][key];
    }
  }

  return options;
}

module.exports = { generateOptions };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Options.html">Options</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Classes</h3><ul><li><a href="Bucket.html">Bucket</a></li><li><a href="Cache.html">Cache</a></li><li><a href="FerretError.html">FerretError</a></li><li><a href="FireFerret.html">FireFerret</a></li><li><a href="QueryKey.html">QueryKey</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Sat Sep 05 2020 16:19:50 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
